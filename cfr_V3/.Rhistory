subset(international_data, country =="China")
subset(allTogetherInternational, country =="China")
tmp <- subset(allTogetherInternational, country =="China")
subset(tmp, min(dateRangeInferred) <= date & date <= max(dateRangeInferred))
dateRangeInferred <- seq(min(as.Date(wuhanInferredData$date)), max(as.Date(wuhanInferredData$date)), 1)
realDataSameDateRange <- subset(subset(allTogetherInternational, country =="China"),
min(dateRangeInferred) <= date & date <= max(dateRangeInferred))
inferredDataDF <- data.frame(date = wuhanInferredData$date,
new_cases = wuhanInferredData$cases,
new_deaths = realDataSameDateRange$new_deaths)
realDataSameDateRange$new_deaths
wuhanInferredData$cases
dateRangeInferred
realDataSameDateRange <- subset(allTogetherInternational, country =="China" &
min(dateRangeInferred) <= date & date <= max(dateRangeInferred))
realDataSameDateRange
inferredDataDF <- data.frame(date = wuhanInferredData$date,
new_cases = wuhanInferredData$cases,
new_deaths = realDataSameDateRange$new_deaths)
wuhanInferredData
deathDataRaw <- readRDS("data/wuhan_data/all_death_prf.rds")
deathDataRaw
subset(deathDataRaw, CNTY_CODE = 420100)
subset(deathDataRaw, CNTY_CODE == 420100)
wuhanDeathData <- subset(deathDataRaw, CNTY_CODE == 420100)
wuhanDeathData <- data.frame(date = subset(deathDataRaw, CNTY_CODE == 420100)$date, subset(deathDataRaw, CNTY_CODE == 420100)$fatality
)
wuhanDeathData
wuhanDeathData <- data.frame(date = subset(deathDataRaw, CNTY_CODE == 420100)$date,
new_deaths = subset(deathDataRaw, CNTY_CODE == 420100)$fatality)
wuhanDeathData
wuhanDeathData <- data.frame(date = subset(deathDataRaw, CNTY_CODE == 420100)$date,
new_deaths = diff(subset(deathDataRaw, CNTY_CODE == 420100)$fatality))
diff(subset(deathDataRaw, CNTY_CODE == 420100)$fatality)
diff(subset(deathDataRaw, CNTY_CODE == 420100))
diff(subset(deathDataRaw, CNTY_CODE == 420100))
diff(subset(deathDataRaw, CNTY_CODE == 420100)$fatality)
wuhanDeathData
diff(wuhanDeathData$new_deaths)
realDeathDataCumulative$deaths[51:54] <- 1
realDeathDataCumulative$deaths[56:57] <- 2
?diff
wuhanDeathData <- data.frame(date = subset(deathDataRaw, CNTY_CODE == 420100)$date,
new_deaths = diff(subset(deathDataRaw, CNTY_CODE == 420100)$fatality))
firstDateInferred <- head(wuhanInferredData$date, n=1)
lastDateInferred <- tail(wuhanInferredData$date, n=1)
firstDateDeath <- head(wuhanDeathData$date, n=1)
dateRangeUnknownDeaths <- seq(as.Date(firstDateInferred), as.Date(firstDateDeath)-1,1)
dateRangeRealData <- seq(as.Date("2020-01-15"),as.Date("2020-02-11"),1)
missingDeathData <- data.frame(date = dateRangeUnknownDeaths,
deaths = rep(0,length(dateRangeUnknownDeaths)))
realDeathDataCumulative <- rbind(missingDeathData,realDeathDataCumulative)
realDeathDataCumulative <- rbind(missingDeathData,wuhanDeathData)
missingDeathData
missingDeathData <- data.frame(date = dateRangeUnknownDeaths,
new_deaths = rep(0,length(dateRangeUnknownDeaths)))
realDeathDataCumulative <- rbind(missingDeathData,wuhanDeathData)
realDeathDataCumulative$deaths[51:54] <- 1
realDeathDataCumulative$deaths[56:57] <- 2
realDeathDataCumulative
realDeathDataCumulative$deaths[51:54] <- 1
realDeathDataCumulative$deaths[56:57] <- 2
wuhanDeathData <- rbind(missingDeathData,wuhanDeathData)
wuhanDeathData$deaths[51:54] <- 1
wuhanDeathData$deaths[56:57] <- 2
wuhanDeathData
wuhanDeathData <- data.frame(date = subset(deathDataRaw, CNTY_CODE == 420100)$date,
deaths = diff(subset(deathDataRaw, CNTY_CODE == 420100)$fatality))
firstDateInferred <- head(wuhanInferredData$date, n=1)
lastDateInferred <- tail(wuhanInferredData$date, n=1)
firstDateDeath <- head(wuhanDeathData$date, n=1)
dateRangeUnknownDeaths <- seq(as.Date(firstDateInferred), as.Date(firstDateDeath)-1,1)
dateRangeRealData <- seq(as.Date("2020-01-15"),as.Date("2020-02-11"),1)
missingDeathData <- data.frame(date = dateRangeUnknownDeaths,
deaths = rep(0,length(dateRangeUnknownDeaths)))
wuhanDeathData <- rbind(missingDeathData,wuhanDeathData)
wuhanDeathData$deaths[51:54] <- 1
wuhanDeathData$deaths[56:57] <- 2
wuhanDeathData
wuhanDeathData <- data.frame(date = subset(deathDataRaw, CNTY_CODE == 420100)$date,
deaths = diff(subset(deathDataRaw, CNTY_CODE == 420100)$fatality))
wuhanDeathData <- data.frame(date = subset(deathDataRaw, CNTY_CODE == 420100)$date,
deaths = subset(deathDataRaw, CNTY_CODE == 420100)$fatality)
wuhanDeathData
wuhanDeathData <- data.frame(date = subset(deathDataRaw, CNTY_CODE == 420100)$date,
deaths = subset(deathDataRaw, CNTY_CODE == 420100)$fatality)
firstDateInferred <- head(wuhanInferredData$date, n=1)
lastDateInferred <- tail(wuhanInferredData$date, n=1)
firstDateDeath <- head(wuhanDeathData$date, n=1)
dateRangeUnknownDeaths <- seq(as.Date(firstDateInferred), as.Date(firstDateDeath)-1,1)
dateRangeRealData <- seq(as.Date("2020-01-15"),as.Date("2020-02-11"),1)
missingDeathData <- data.frame(date = dateRangeUnknownDeaths,
deaths = rep(0,length(dateRangeUnknownDeaths)))
wuhanDeathData <- rbind(missingDeathData,wuhanDeathData)
wuhanDeathData$deaths[51:54] <- 1
wuhanDeathData$deaths[56:57] <- 2
wuhanDeathData
wuhanDeathDataIncidence <- diff(wuhanDeathData$deaths)
wuhanDeathDataIncidence
dateRangeUnknownDeaths
dateRangeRealData
wuhanInferredData$date
wuhanInferredData$date[2:length(wuhanInferredData$date)]
dateRangeIncidence <- wuhanInferredData$date[2:length(wuhanInferredData$date)]
inferredDataDF <- data.frame(date = wuhanInferredData$date,
new_cases = wuhanInferredData$cases,
new_deaths = realDataSameDateRange$new_deaths)
wuhanInferredData
realDataSameDateRange
wuhanDeathDataIncidence <- diff(wuhanDeathData$deaths)
dateRangeIncidence <- wuhanInferredData$date[2:length(wuhanInferredData$date)]
wuhanDeathData
inferredDataDF <- data.frame(date = wuhanInferredData$date,
new_cases = wuhanInferredData$cases,
new_deaths = wuhanDeathData$new_deaths)
inferredDataDF <- data.frame(date = wuhanInferredData$date,
new_cases = wuhanInferredData$cases,
new_deaths = wuhanDeathDataIncidence)
inferredDataDF <- data.frame(date = dateRangeIncidence,
new_cases = wuhanInferredData$cases,
new_deaths = wuhanDeathDataIncidence)
inferredDataDF <- data.frame(date = dateRangeIncidence,
new_cases =wuhanInferredData$cases[2:length(wuhanInferredData$cases)],
new_deaths = wuhanDeathDataIncidence)
inferredDataDF
allTogetherInferred <- data.frame(date = dateRangeIncidence,
new_cases =wuhanInferredData$cases[2:length(wuhanInferredData$cases)],
new_deaths = wuhanDeathDataIncidence)
master_plot(allTogetherInferred, 20)
allTogetherInferred
allTogetherInferred$date <- as.Date(allTogetherInferred$date)
master_plot(allTogetherInferred, 20)
master_plot(allTogetherInferred, 30)
master_plot(allTogetherInferred, 22)
allTogetherInferred
source("R/cCFR_calculation.R")
master_plot(allTogetherInferred, startIntcfr = 1, startIntCD = 30)
master_plot(allTogetherInferred, 1,  30)
master_plot(allTogetherInferred, 1, 1)
source("R/plotting_function.R")
source("R/plotting_functions.R")
master_plot(allTogetherInferred, 1, 1)
allTogetherInferred$date <- as.Date(allTogetherInferred$date)
master_plot(allTogetherInferred, 1, 1)
master_plot(allTogetherInferred, 1, 30)
master_plot(allTogetherInferred, 1, 60)
master_plot(allTogetherInferred, 1, 50)
source("R/cCFR_calculation.R")
source("R/plotting_functions.R")
master_plot(allTogetherInferred, 1, 50)
master_plot(ChinaData, 20, 20)
master_plot(ChinaData, 10, 10)
ChinaData <- subset(allTogetherInternational, country == "China")
master_plot(ChinaData, 10, 10)
ChinaData
master_plot(ChinaData, 1,1)
master_plot(ChinaData, 5,1)
master_plot(ChinaData, 5, 5)
source("R/cCFR_calculation.R")
source("R/plotting_functions.R")
master_plot(ChinaData, 5, 5)
master_plot(ChinaData, 10, 10)
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
master_plot(ChinaData, 15, 15)
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/cCFR_calculation.R")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
master_plot(ChinaData, 15, 15, , "bottomright")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/cCFR_calculation.R")
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/cCFR_calculation.R")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/cCFR_calculation.R")
source("R/plotting_functions.R")
master_plot(JapanData, 1)
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
?mtext
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/cCFR_calculation.R")
source("R/plotting_functions.R")
master_plot(JapanData, 1)
function (x, y = NULL, legend, fill = NULL, col = par("col"),
border = "black", lty, lwd, pch, angle = 45, density = NULL,
bty = "o", bg = par("bg"), box.lwd = par("lwd"), box.lty = par("lty"),
box.col = par("fg"), pt.bg = NA, cex = 1, pt.cex = cex,
pt.lwd = lwd, xjust = 0, yjust = 1, x.intersp = 1, y.intersp = 1,
adj = c(0, 0.5), text.width = NULL, text.col = par("col"),
text.font = NULL, merge = do.lines && has.pch, trace = FALSE,
plot = TRUE, ncol = 1, horiz = FALSE, title = NULL, inset = 0,
xpd, title.col = text.col, title.adj = 0.5, seg.len = 2)
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/cCFR_calculation.R")
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/plotting_functions.R")
master_plot(JapanData, 1)
master_plot(ChinaData, 15, 15, "bottomright")
?subplot
??subplot
??Subplot
library(plotly)
install.packages("plotly")
library(plotly)
master_plot(ChinaData, 15, 15, "bottomright")
?subplot
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
master_plot(ChinaData, 15, 15, "bottomright")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
source("R/plotting_functions.R")
master_plot(ChinaData, 15, 15, "bottomright")
master_plot(allTogetherInferred, 1, 50, "bottomright")
allTogetherInternational$date <- as.Date(allTogetherInternational$date)
ChinaData <- subset(allTogetherInternational, country == "China")
JapanData <- subset(allTogetherInternational, country == "Japan")
KoreaData <- subset(allTogetherInternational, country == "South Korea")
IranData  <- subset(allTogetherInternational, country == "Iran")
master_plot(allTogetherInferred, 1, 50, "bottomright")
allTogetherInferred <- data.frame(date  = as.Date(dateRangeIncidence),
new_cases  = wuhanInferredData$cases[2:length(wuhanInferredData$cases)],
new_deaths = wuhanDeathDataIncidence)
master_plot(allTogetherInferred, 1, 50, "bottomright")
allTogetherInferred$date
allTogetherInferred$date %>% class
allTogetherInferred
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
master_plot(allTogetherInferred, 1, 50, "bottomright")
master_plot(allTogetherInferred, 1, 30, "bottomright")
output_cfr(allTogetherInferred, hospitalisation_to_death_truncated)
output_cfr_timeseries(allTogetherInferred, hospitalisation_to_death_truncated)
master_plot(JapanData, 1, 1, "bottomright")
master_plot(KoreaData, 1, 1, "bottomright")
master_plot(KoreaData, 1, 1, "topright")
master_plot(IranData, 1, 1, "topright")
master_plot(IranData, 1, 1, "right")
allTogetherInferred
allTogetherInferred <- data.frame(date  = dateRangeIncidence,
new_cases  = wuhanInferredData$cases[2:length(wuhanInferredData$cases)],
new_deaths = wuhanDeathDataIncidence)
master_plot(allTogetherInferred, 1, 30, "bottomright")
allTogetherInferred <- data.frame(date  = as.Date(dateRangeIncidence),
new_cases  = wuhanInferredData$cases[2:length(wuhanInferredData$cases)],
new_deaths = wuhanDeathDataIncidence)
master_plot(allTogetherInferred, 1, 30, "bottomright")
master_plot(allTogetherInferred, 1, 30, "bottomright")
allTogetherInferred %>% class
allTogetherInferred$date %>% class
as.Date(allTogetherInferred$date) %>% class
allTogetherInferred$date <- as.Date(allTogetherInferred$date)
allTogetherInferred
master_plot(allTogetherInferred, 1, 30, "bottomright")
master_plot(allTogetherInferred, 1, 30, "topleft")
master_plot(allTogetherInferred, 1, 50, "topleft")
master_plot(allTogetherInferred, 1, 48, "topleft")
master_plot(ChinaData, 15, 15, "bottomright")
master_plot(JapanData, 1, 1, "bottomright")
master_plot(JapanData, 1, 1, "top")
master_plot(KoreaData, 1, 1, "topright")
master_plot(IranData, 1, 1, "right")
output_estimates(ChinaData, hospitalisation_to_death_truncated)
output_estimates <- function(data_in, delay_fun)
{
timeSeries <- cCFR_with_CIs_main_time_series(data_in, delay_fun)
tail(timeSeries, n = 1)
}
#
output_estimates(ChinaData, hospitalisation_to_death_truncated)
output_estimates <- function(data_in, delay_fun)
{
timeSeriesnCFR <- computenCFRTimeSeries(data_in, delay_fun)
timeSeriescCFR <- computecCFRTimeSeries(data_in, delay_fun)
tail1 <- tail(timeSeriesnCFR, n = 1)
tail2 <- tail(timeSeriescCFR, n = 1)
return(rbind(tail1, tail2))
}
output_estimates(ChinaData, hospitalisation_to_death_truncated)
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
master_plot <- function(data_in,
startIntCFR,
startIntCD,
legendPosition)
{
dev.off()
#layout(matrix(c(1,
#                 2,
#                 3
# ),
# nrow=3, byrow=TRUE))
par(mfrow =c(3,1),
oma = c(1,1,1,1) + 0.5,
mar = c(0,0,1,1) + 0.1)
nCFRTimeSeriesOutput <- computenCFRTimeSeries(data_in)
cCFRTimeSeriesOutput <- computecCFRTimeSeries(data_in)
plotCFRTimeSeries(nCFRTimeSeriesOutput, cCFRTimeSeriesOutput, startIntCFR, legendPosition)
plotCaseIncidence(data_in, startIntCD)
plotDeathIncidence(data_in, startIntCD)
return(tail(nCFRTimeSeriesOutput, n = 1), tail(cCFRTimeSeriesOutput, n = 1))
#subplot(plot1, plot2, plot3, nrows = 3, margin = 0.04)
}
master_plot(allTogetherInferred, 1, 48, "topleft")
source('~/Documents/lshtm/github repos/CFR_calculation/cfr_V3/R/plotting_functions.R')
master_plot <- function(data_in,
startIntCFR,
startIntCD,
legendPosition)
{
dev.off()
#layout(matrix(c(1,
#                 2,
#                 3
# ),
# nrow=3, byrow=TRUE))
par(mfrow =c(3,1),
oma = c(1,1,1,1) + 0.5,
mar = c(0,0,1,1) + 0.1)
nCFRTimeSeriesOutput <- computenCFRTimeSeries(data_in)
cCFRTimeSeriesOutput <- computecCFRTimeSeries(data_in)
plotCFRTimeSeries(nCFRTimeSeriesOutput, cCFRTimeSeriesOutput, startIntCFR, legendPosition)
plotCaseIncidence(data_in, startIntCD)
plotDeathIncidence(data_in, startIntCD)
outputEstimates <- cbind(tail(nCFRTimeSeriesOutput, n = 1), tail(cCFRTimeSeriesOutput, n = 1))
return(outputEstimates)
#subplot(plot1, plot2, plot3, nrows = 3, margin = 0.04)
}
master_plot(allTogetherInferred, 1, 48, "topleft")
rm(list = ls())
library(lubridate)
library(bbmle)
library(plotrix)
library(fitdistrplus)
# read in data
scaled_reporting <- 1.0
source("R/read_dataV2.R")
######### parameterising the delay distributions (taken from papers) ############
# Estimating distribution from onset of symptoms to death
# Linton et al. (https://doi.org/10.3390/jcm9020538)
zmean <- 14.5
zsd <- 6.7
zmedian <- 13.2
muOD <- log(zmedian)
sigmaOD <- sqrt( 2*(log(zmean) - muOD) )
onset_to_death <- function(x)
{
dlnorm(x, muOD, sigmaOD)
}
zmean <- 20.2
zsd <- 11.6
zmedian <- 17.1
muODT <- log(zmedian)
sigmaODT <- sqrt( 2*(log(zmean) - muODT) )
onset_to_death_truncated <- function(x)
{
dlnorm(x, muODT, sigmaODT)
}
zmean <- 8.6
zsd <- 6.7
zmedian <- 6.7
muHD <- log(zmedian)
sigmaHD <- sqrt( 2*(log(zmean) - muHD) )
hospitalisation_to_death <- function(x)
{
dlnorm(x, muHD, sigmaHD)
}
zmean <- 13
zsd <- 12.7
zmedian <- 9.1
muHDT <- log(zmedian)
sigmaHDT <- sqrt( 2*(log(zmean) - muHDT) )
hospitalisation_to_death_truncated <- function(x)
{
dlnorm(x, muHDT, sigmaHDT)
}
source("R/cCFR_calculation.R")
source("R/plotting_functions.R")
ChinaData <- subset(allTogetherInternational, country == "China")
JapanData <- subset(allTogetherInternational, country == "Japan")
KoreaData <- subset(allTogetherInternational, country == "South Korea")
IranData  <- subset(allTogetherInternational, country == "Iran")
master_plot(allTogetherInferred, 1, 48, "topleft")
master_plot(ChinaData, 15, 15, "bottomright")
master_plot(JapanData, 1, 1, "top")
master_plot(KoreaData, 1, 1, "topright")
master_plot(IranData, 1, 1, "right")
master_plot(allTogetherInferred, 1, 48, "topleft", hospitalisation_to_death)
source("R/plotting_functions.R")
master_plot(allTogetherInferred, 1, 48, "topleft", hospitalisation_to_death)
source("R/cCFR_calculation.R")
source("R/plotting_functions.R")
master_plot(allTogetherInferred, 1, 48, "topleft", hospitalisation_to_death)
source("R/cCFR_calculation.R")
source("R/plotting_functions.R")
master_plot(allTogetherInferred, 1, 48, "topleft", hospitalisation_to_death)
ItalyData <- subset(allTogetherInternational, country == "Italy")
master_plot(ItalyData, 1, 1, "right")
master_plot(ItalyData, 1, 1, "right", hospitalisation_to_death)
master_plot(ItalyData, 1, 1, "topright", hospitalisation_to_death_truncated)
master_plot(allTogetherInferred, 1, 48, "topleft", hospitalisation_to_death)
master_plot(JapanData, 1, 1, "top", hospitalisation_to_death)
master_plot(KoreaData, 1, 1, "topright", hospitalisation_to_death)
master_plot(IranData, 1, 1, "right", hospitalisation_to_death)
master_plot(ItalyData, 1, 1, "topright", hospitalisation_to_death)
master_plot(allTogetherInferred, 1, 48, "topleft", hospitalisation_to_death_truncated)
master_plot(JapanData, 1, 1, "top", hospitalisation_to_death_truncated)
master_plot(KoreaData, 1, 1, "topright", hospitalisation_to_death_truncated)
master_plot(IranData, 1, 1, "right", hospitalisation_to_death_truncated)
master_plot(ItalyData, 1, 1, "topright", hospitalisation_to_death_truncated)
master_plot(JapanData, 1, 1, "top", hospitalisation_to_death)
master_plot(JapanData, 1, 1, "top", hospitalisation_to_death_truncated)
master_plot(KoreaData, 1, 1, "top", hospitalisation_to_death)
max(KoreaData$date)
master_plot(KoreaData, 1, 1, "top", hospitalisation_to_death_truncated)
master_plot(IranData, 1, 1, "top", hospitalisation_to_death)
master_plot(ItalyData, 1, 1, "top", hospitalisation_to_death)
master_plot(ItalyData, 1, 1, "top", hospitalisation_to_death_truncated)
data <- read.csv("../../data2019nCoV/data-raw/WHO_SR.csv")
data %>% View
data$InternationalConveyance
cruiseShipCase <- data.frame(date = data$Date, data$InternationalConveyance
)
allTogetherInternational$country
unique(allTogetherInternational$country)
countries <- unique(allTogetherInternational$country)
countries %>% View
data
data %>% View
load("../../data2019nCoV/data/WHO_SR.rda")
View(WHO_SR)
View(WHO_SR)
cruise_ship_by_confmation <- read.csv("data/cruise_ship_data/cruise_ship_diamond_princess_by_confirmation.csv")
cruise_ship_by_confmation
cruise_ship_by_confmation$date <- as.Date(cruise_ship_by_confmation$date)
master_plot(cruise_ship_by_confmation, 1, 1, "topright", hospitalisation_to_death_truncated)
